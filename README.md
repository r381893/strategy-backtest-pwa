# Strategy Backtest PWA

é«˜ç´šå›æ¸¬ç³»çµ± Pro çš„ PWA ç‰ˆæœ¬ï¼Œæ¡ç”¨å‰ç«¯ + Render å¾Œç«¯ + Firebase æ¶æ§‹ã€‚

## å°ˆæ¡ˆçµæ§‹

```
pwa/
â”œâ”€â”€ frontend/               # å‰ç«¯ PWA (GitHub Pages)
â”‚   â”œâ”€â”€ index.html         # ä¸»é é¢
â”‚   â”œâ”€â”€ css/style.css      # æ¨£å¼æª”
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ app.js              # ä¸»æ‡‰ç”¨é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ firebase-config.js  # Firebase è¨­å®š
â”‚   â”‚   â”œâ”€â”€ file-parser.js      # Excel è§£æ
â”‚   â”‚   â””â”€â”€ chart.js            # åœ–è¡¨ç¹ªè£½
â”‚   â”œâ”€â”€ manifest.json      # PWA manifest
â”‚   â””â”€â”€ sw.js              # Service Worker
â”œâ”€â”€ backend/               # Render å¾Œç«¯
â”‚   â”œâ”€â”€ app.py             # Flask API
â”‚   â”œâ”€â”€ backtest.py        # å›æ¸¬å¼•æ“
â”‚   â”œâ”€â”€ optimizer.py       # åƒæ•¸å„ªåŒ–å™¨
â”‚   â””â”€â”€ requirements.txt   # Python ä¾è³´
â””â”€â”€ .github/workflows/     # CI/CD
    â””â”€â”€ deploy.yml         # GitHub Pages è‡ªå‹•éƒ¨ç½²
```

## åŠŸèƒ½

- ğŸ“ **è³‡æ–™é è¦½**ï¼šä¸Šå‚³ Excel æª”æ¡ˆï¼Œè‡ªå‹•è­˜åˆ¥æ—¥æœŸ/åƒ¹æ ¼æ¬„ä½
- âš™ï¸ **ç­–ç•¥è¨­å®š**ï¼šè¨­å®šå›æ¸¬åƒæ•¸ï¼ˆæ§“æ¡¿ã€æ‰‹çºŒè²»ã€ç­–ç•¥é¡å‹ç­‰ï¼‰
- ğŸ“Š **å›æ¸¬å ±è¡¨**ï¼šé¡¯ç¤ºç¸¾æ•ˆæŒ‡æ¨™ã€æ·¨å€¼æ›²ç·šã€å›æ’¤åˆ†æ
- ğŸ“‹ **äº¤æ˜“æ˜ç´°**ï¼šäº¤æ˜“çµ±è¨ˆæ‘˜è¦å’Œæ­·å²äº¤æ˜“ç´€éŒ„
- ğŸ” **åƒæ•¸å„ªåŒ–**ï¼šè‡ªå‹•æœå°‹æœ€ä½³ç­–ç•¥åƒæ•¸çµ„åˆ
- ğŸ’¾ **å·²å„²å­˜ç­–ç•¥**ï¼šæŸ¥çœ‹ Firebase ä¸­å„²å­˜çš„æœ€ä½³ç­–ç•¥

## éƒ¨ç½²

### å‰ç«¯ (GitHub Pages)

1. å°‡ `frontend` è³‡æ–™å¤¾æ¨é€åˆ° GitHub
2. å•Ÿç”¨ GitHub Pagesï¼ˆSettings > Pages > Source: GitHub Actionsï¼‰
3. æ¯æ¬¡æ¨é€åˆ° main åˆ†æ”¯æœƒè‡ªå‹•éƒ¨ç½²

### å¾Œç«¯ (Render)

1. åœ¨ Render å»ºç«‹æ–°çš„ Web Service
2. é€£æ¥ GitHub repository
3. è¨­å®šï¼š
   - Root Directory: `backend`
   - Build Command: `pip install -r requirements.txt`
   - Start Command: `gunicorn app:app`
4. éƒ¨ç½²å¾Œæ›´æ–°å‰ç«¯ `app.js` ä¸­çš„ `API_BASE_URL`

### Firebase

ä½¿ç”¨ç¾æœ‰çš„ `backtesting-system-pro` Firebase å°ˆæ¡ˆï¼š
- Database URL: `https://backtesting-system-pro-default-rtdb.asia-southeast1.firebasedatabase.app/`

> âš ï¸ è¨˜å¾—åœ¨ `frontend/js/firebase-config.js` ä¸­å¡«å…¥æ­£ç¢ºçš„ Firebase API Key

## æœ¬åœ°é–‹ç™¼

### å‰ç«¯
```bash
cd frontend
# ä½¿ç”¨ä»»ä½• HTTP ä¼ºæœå™¨
python -m http.server 8000
```

### å¾Œç«¯
```bash
cd backend
pip install -r requirements.txt
python app.py
```

## æŠ€è¡“æ£§

- **å‰ç«¯**ï¼šVanilla JS + Plotly.js + SheetJS + Firebase SDK
- **å¾Œç«¯**ï¼šFlask + Pandas + NumPy
- **éƒ¨ç½²**ï¼šGitHub Pages + Render
- **è³‡æ–™åº«**ï¼šFirebase Realtime Database

---

## è¨­è¨ˆé‚è¼¯

### æ¶æ§‹é¸æ“‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Pages   â”‚â”€â”€â”€â”€â–¶â”‚     Render      â”‚â”€â”€â”€â”€â–¶â”‚    Firebase     â”‚
â”‚   (å‰ç«¯ PWA)    â”‚     â”‚  (Python API)   â”‚     â”‚  (Realtime DB)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‚ºä»€éº¼é¸æ“‡é€™å€‹æ¶æ§‹ï¼Ÿ**

| å…ƒä»¶ | é¸æ“‡ç†ç”± |
|------|----------|
| **GitHub Pages** | å…è²»ã€è‡ªå‹• HTTPSã€èˆ‡ Git æ•´åˆã€æ”¯æ´ PWA |
| **Render** | å…è²» tierã€æ”¯æ´ Pythonã€è‡ªå‹•éƒ¨ç½²ã€CORS å‹å¥½ |
| **Firebase** | å³æ™‚åŒæ­¥ã€å…è²»é¡åº¦å¤§ã€å‰å¾Œç«¯éƒ½èƒ½å­˜å– |

### å‰å¾Œç«¯åˆ†é›¢çš„å„ªå‹¢

1. **ç¨ç«‹æ“´å±•**ï¼šå‰ç«¯å’Œå¾Œç«¯å¯ä»¥åˆ†åˆ¥æ“´å±•å’Œæ›´æ–°
2. **å¿«é€Ÿè¿­ä»£**ï¼šå‰ç«¯ UI æ›´æ–°ä¸éœ€é‡æ–°éƒ¨ç½²å¾Œç«¯
3. **é›¢ç·šæ”¯æ´**ï¼šPWA å¯ä»¥åœ¨é›¢ç·šæ™‚é¡¯ç¤ºå¿«å–çš„ç­–ç•¥è³‡æ–™
4. **æˆæœ¬æ§åˆ¶**ï¼šè¨ˆç®—å¯†é›†çš„å›æ¸¬åœ¨å¾Œç«¯åŸ·è¡Œï¼Œå‰ç«¯ä¿æŒè¼•é‡

### å›æ¸¬é‚è¼¯ï¼ˆå¾Œç«¯è¨ˆç®—ï¼‰

```
ä¸Šå‚³ Excel â†’ è§£æè³‡æ–™ â†’ API é€è‡³å¾Œç«¯ â†’ Python å›æ¸¬è¨ˆç®— â†’ è¿”å›çµæœ
```

**é¸æ“‡å¾Œç«¯è¨ˆç®—çš„åŸå› **ï¼š
- å›æ¸¬æ¶‰åŠå¤§é‡æ•¸å€¼è¨ˆç®—ï¼ˆå‡ç·šã€æç›Šã€MDD ç­‰ï¼‰
- Python çš„ Pandas/NumPy æ•ˆèƒ½å„ªæ–¼ JavaScript
- åŸæœ‰ç¨‹å¼ç¢¼å¯ç›´æ¥ç§»æ¤ï¼Œæ¸›å°‘è½‰æ›éŒ¯èª¤
- æ”¯æ´æ›´å¤§çš„è³‡æ–™é›†ï¼ˆæ•¸è¬ç­†æ­·å²è³‡æ–™ï¼‰

### ç­–ç•¥é¡å‹

| ç­–ç•¥ | é€²å ´é‚è¼¯ | å‡ºå ´é‚è¼¯ |
|------|----------|----------|
| **æ°¸é åšå¤š** | ç¬¬ä¸€å¤©å…¨å€‰åšå¤š | ä¸å‡ºå ´ï¼ˆæŒæœ‰åˆ°åº•ï¼‰ |
| **å–®å‡ç·š** | åƒ¹æ ¼ä¸Šç©¿ MA | åƒ¹æ ¼ä¸‹ç©¿ MA |
| **é›™å‡ç·š** | å¿«ç·šä¸Šç©¿æ…¢ç·š | å¿«ç·šä¸‹ç©¿æ…¢ç·š |

### ç¸¾æ•ˆæŒ‡æ¨™è¨ˆç®—

- **CAGR**ï¼š`(æœ€çµ‚æ·¨å€¼ / åˆå§‹è³‡é‡‘)^(1/å¹´æ•¸) - 1`
- **MDD**ï¼šæ­·å²æœ€å¤§å›æ’¤ç™¾åˆ†æ¯”
- **Sharpe**ï¼š`(å¹´åŒ–å ±é…¬ - ç„¡é¢¨éšªåˆ©ç‡) / å¹´åŒ–æ¨™æº–å·®`
- **Calmar**ï¼š`CAGR / MDD`

### Firebase è³‡æ–™çµæ§‹

```json
{
  "best_strategies": {
    "è³‡ç”¢åç¨±_å›æ¸¬å€é–“": {
      "asset": "åŠ æ¬ŠæŒ‡æ•¸",
      "strategy": "æ°¸é åšå¤š",
      "leverage": 2.0,
      "total_return": 0.85,
      "cagr": 0.12,
      "mdd": 0.25,
      "saved_at": "2024-12-27 13:30:00"
    }
  }
}
```

---

## åŸç‰ˆ Streamlit å°ç…§

æœ¬ PWA ç‰ˆæœ¬å®Œæ•´ç§»æ¤äº†åŸ Streamlit æ‡‰ç”¨çš„æ‰€æœ‰åŠŸèƒ½ï¼š

| Streamlit åŸç‰ˆ | PWA ç‰ˆæœ¬ |
|----------------|----------|
| `st.file_uploader` | SheetJS + Drag & Drop |
| `st.number_input`, `st.selectbox` | HTML form elements |
| `st.plotly_chart` | Plotly.js |
| `st.dataframe` | HTML Table |
| `st.tabs` | Tab Navigation |
| Firebase Admin SDK | Firebase Web SDK |
